<!DOCTYPE html>
<html>
<head>
    <title>Final System Test</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .test-btn { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        .test-btn:hover { background: #0056b3; }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        .result { margin: 10px 0; padding: 10px; border-radius: 3px; }
        .result.success { background: #d4edda; border: 1px solid #c3e6cb; }
        .result.error { background: #f8d7da; border: 1px solid #f5c6cb; }
        .result.info { background: #d1ecf1; border: 1px solid #bee5eb; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª Ú©ÙØ´ - ØªØ³Øª Ù†Ù‡Ø§ÛŒÛŒ</h1>
        
        <div class="test-section">
            <h2>ğŸ” ØªØ³Øª ÙˆØ¶Ø¹ÛŒØª Ø³Ø±Ùˆ</h2>
            <button class="test-btn" onclick="checkServer()">Ú†Ú© Ú©Ø±Ø¯Ù† Ø³Ø±Ùˆ</button>
            <div id="server-result"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“Š ØªØ³Øª Ø³ÛŒØ³ØªÙ… Ø§ØµÙ„ÛŒ</h2>
            <button class="test-btn" onclick="openMainSystem()">Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø³ÛŒØ³ØªÙ… Ø§ØµÙ„ÛŒ</button>
            <button class="test-btn" onclick="testFunctions()">ØªØ³Øª ØªÙˆØ§Ø¨Ø¹</button>
            <div id="main-result"></div>
        </div>
        
        <div class="test-section">
            <h2>âœ… ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø¯Ø³ØªÛŒ</h2>
            <p>Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ú©Ø§Ù…Ù„ØŒ Ù„Ø·ÙØ§Ù‹ Ù…Ø±Ø§Ø­Ù„ Ø²ÛŒØ± Ø±Ø§ Ø¨Ù‡ ØµÙˆØ±Øª Ø¯Ø³ØªÛŒ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯:</p>
            <ol>
                <li>Ø¨Ø± Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ "Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø³ÛŒØ³ØªÙ… Ø§ØµÙ„ÛŒ" Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯</li>
                <li>Ø¯Ø± ØªØ¨ "ğŸ“¦ ÙˆØ±ÙˆØ¯ÛŒ" Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯</li>
                <li>ÛŒÚ© Ù…Ø­ØµÙˆÙ„ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</li>
                <li>Ø±Ù†Ú¯ Ùˆ ØªØ¹Ø¯Ø§Ø¯ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</li>
                <li>Ø¯Ú©Ù…Ù‡ "â• Ø§ÙØ²ÙˆØ¯Ù†" Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯</li>
                <li>Ù†ØªÛŒØ¬Ù‡ Ø±Ø§ Ú¯Ø²Ø§Ø±Ø´ Ø¯Ù‡ÛŒØ¯</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“‹ Ú¯Ø²Ø§Ø±Ø´ Ù…Ø´Ú©Ù„Ø§Øª</h2>
            <p>Ø§Ú¯Ø± Ù…Ø´Ú©Ù„ÛŒ Ø¯Ø§Ø±ÛŒØ¯ØŒ Ù„Ø·ÙØ§Ù‹:</p>
            <ul>
                <li>Ù…Ø±ÙˆØ±Ú¯Ø± Ø±Ø§ Ø¨Ø§Ø² Ùˆ Ø¨Ø³ØªÙ‡ Ú©Ù†ÛŒØ¯</li>
                <li>Ctrl+Shift+I Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯ ØªØ§ Developer Tools Ø¨Ø§Ø² Ø´ÙˆØ¯</li>
                <li>Ø¨Ù‡ ØªØ¨ Console Ø¨Ø±ÙˆÛŒØ¯</li>
                <li>Ø®Ø·Ø§Ù‡Ø§ÛŒ Ù‚Ø±Ù…Ø² Ø±Ø§ Ú¯Ø²Ø§Ø±Ø´ Ø¯Ù‡ÛŒØ¯</li>
            </ul>
        </div>
    </div>

    <script>
        function log(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : 'info';
            element.innerHTML += `<div class="result ${type}">${message}</div>`;
        }

        function checkServer() {
            document.getElementById('server-result').innerHTML = '';
            log('server-result', 'ğŸ” Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ Ø³Ø±Ùˆ...', 'info');
            
            fetch('http://localhost:8006/index.html')
                .then(response => {
                    if (response.ok) {
                        log('server-result', 'âœ… Ø³Ø±Ùˆ Ø¯Ø± Ø­Ø§Ù„ Ú©Ø§Ø± Ø§Ø³Øª', 'success');
                        log('server-result', `ğŸ“„ ÙˆØ¶Ø¹ÛŒØª Ù¾Ø§Ø³Ø®: ${response.status}`, 'info');
                        return response.text();
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                })
                .then(data => {
                    log('server-result', `ğŸ“Š Ø§Ù†Ø¯Ø§Ø²Ù‡ ÙØ§ÛŒÙ„: ${data.length} Ú©Ø§Ø±Ø§Ú©ØªØ±`, 'info');
                    log('server-result', 'âœ… ÙØ§ÛŒÙ„ Ø§ØµÙ„ÛŒ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ø§Ø³Øª', 'success');
                })
                .catch(error => {
                    log('server-result', 'âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø³Ø±Ùˆ: ' + error.message, 'error');
                });
        }

        function openMainSystem() {
            const mainResult = document.getElementById('main-result');
            mainResult.innerHTML = '';
            log('main-result', 'ğŸ”„ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø³ÛŒØ³ØªÙ… Ø§ØµÙ„ÛŒ...', 'info');
            
            const iframe = document.createElement('iframe');
            iframe.src = 'index.html';
            iframe.style.width = '100%';
            iframe.style.height = '500px';
            iframe.style.border = '1px solid #ddd';
            iframe.style.borderRadius = '5px';
            
            iframe.onload = function() {
                log('main-result', 'âœ… Ø³ÛŒØ³ØªÙ… Ø§ØµÙ„ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯', 'success');
                
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    const iframeWindow = iframe.contentWindow;
                    
                    // Check if key functions exist
                    if (iframeWindow.addEntry) {
                        log('main-result', 'âœ… ØªØ§Ø¨Ø¹ addEntry ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯', 'success');
                    } else {
                        log('main-result', 'âŒ ØªØ§Ø¨Ø¹ addEntry ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯', 'error');
                    }
                    
                    if (iframeWindow.showTab) {
                        log('main-result', 'âœ… ØªØ§Ø¨Ø¹ showTab ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯', 'success');
                    } else {
                        log('main-result', 'âŒ ØªØ§Ø¨Ø¹ showTab ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯', 'error');
                    }
                    
                    if (iframeWindow.saveEntry) {
                        log('main-result', 'âœ… ØªØ§Ø¨Ø¹ saveEntry ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯', 'success');
                    } else {
                        log('main-result', 'âŒ ØªØ§Ø¨Ø¹ saveEntry ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯', 'error');
                    }
                    
                    // Check HTML elements
                    if (iframeDoc.getElementById('entry-product-select')) {
                        log('main-result', 'âœ… element entry-product-select ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯', 'success');
                    } else {
                        log('main-result', 'âŒ element entry-product-select ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯', 'error');
                    }
                    
                    if (iframeDoc.getElementById('entry-temp-body')) {
                        log('main-result', 'âœ… element entry-temp-body ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯', 'success');
                    } else {
                        log('main-result', 'âŒ element entry-temp-body ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯', 'error');
                    }
                    
                } catch (e) {
                    log('main-result', 'âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ iframe: ' + e.message, 'error');
                }
            };
            
            iframe.onerror = function() {
                log('main-result', 'âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø³ÛŒØ³ØªÙ… Ø§ØµÙ„ÛŒ', 'error');
            };
            
            mainResult.appendChild(iframe);
        }

        function testFunctions() {
            log('main-result', 'ğŸ” ØªØ³Øª ØªÙˆØ§Ø¨Ø¹ JavaScript...', 'info');
            
            // Create a test iframe to access the main system functions
            const iframe = document.createElement('iframe');
            iframe.src = 'index.html';
            iframe.style.display = 'none';
            
            iframe.onload = function() {
                try {
                    const iframeWindow = iframe.contentWindow;
                    
                    // Test if functions are available
                    const functions = ['addEntry', 'showTab', 'saveEntry', 'updateEntryProductSelect'];
                    
                    functions.forEach(funcName => {
                        if (typeof iframeWindow[funcName] === 'function') {
                            log('main-result', `âœ… ${funcName} ÛŒÚ© ØªØ§Ø¨Ø¹ Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª`, 'success');
                        } else {
                            log('main-result', `âŒ ${funcName} ØªØ§Ø¨Ø¹ Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª`, 'error');
                        }
                    });
                    
                    // Test if global variables exist
                    const variables = ['products', 'entryInvoices', 'tempEntryItems'];
                    
                    variables.forEach(varName => {
                        if (typeof iframeWindow[varName] !== 'undefined') {
                            log('main-result', `âœ… Ù…ØªØºÛŒØ± ${varName} Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª`, 'success');
                        } else {
                            log('main-result', `âŒ Ù…ØªØºÛŒØ± ${varName} Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª`, 'error');
                        }
                    });
                    
                } catch (e) {
                    log('main-result', 'âŒ Ø®Ø·Ø§ Ø¯Ø± ØªØ³Øª ØªÙˆØ§Ø¨Ø¹: ' + e.message, 'error');
                }
                
                document.body.removeChild(iframe);
            };
            
            document.body.appendChild(iframe);
        }

        // Initialize page
        window.onload = function() {
            document.getElementById('server-result').innerHTML = '<div class="result info">ğŸ“‹ Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø±ÙˆØ¹ ØªØ³Øª</div>';
            log('server-result', 'ğŸš€ ØµÙØ­Ù‡ ØªØ³Øª Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª', 'success');
        };
    </script>
</body>
</html>